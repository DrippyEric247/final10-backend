{"ast":null,"code":"import React,{useState}from'react';import{useQuery}from'@tanstack/react-query';import{motion}from'framer-motion';import{MapPin,Clock,DollarSign,Truck,Users,Zap,Search,Filter,Star,TrendingUp,ShoppingCart}from'lucide-react';import ebayService from'../services/ebayService';import{trackLocalDealsSearch}from'../lib/api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const LocalDeals=()=>{var _searchResults$items,_trendingData$items,_trendingData$items2,_categoryData$items;const[searchTerm,setSearchTerm]=useState('');const[selectedCategory,setSelectedCategory]=useState('all');const[searchRadius,setSearchRadius]=useState(25);const[activeTab,setActiveTab]=useState('search');const categories=[{id:'all',name:'All Deals',icon:'🛍️'},{id:'electronics',name:'Electronics',icon:'📱'},{id:'furniture',name:'Furniture',icon:'🪑'},{id:'vehicles',name:'Vehicles',icon:'🚗'},{id:'fashion',name:'Fashion',icon:'👕'},{id:'tools',name:'Tools',icon:'🔧'},{id:'toys',name:'Toys',icon:'🧸'},{id:'books',name:'Books',icon:'📚'}];// Search eBay deals query\nconst{data:searchResults,isLoading:searchLoading,error:searchError,refetch:refetchSearch}=useQuery({queryKey:['ebaySearch',searchTerm,searchRadius],queryFn:()=>ebayService.searchItems({keywords:searchTerm,limit:15}),enabled:false,// Only run when manually triggered\nretry:1});// Trending eBay deals query\nconst{data:trendingData,isLoading:trendingLoading,error:trendingError}=useQuery({queryKey:['trendingEbay',selectedCategory],queryFn:()=>ebayService.getTrendingItems(selectedCategory,20),enabled:activeTab==='trending'});// Category deals query\nconst{data:categoryData,isLoading:categoryLoading,error:categoryError}=useQuery({queryKey:['ebayCategory',selectedCategory],queryFn:()=>ebayService.searchItems({categoryId:selectedCategory,limit:15}),enabled:activeTab==='category'&&selectedCategory!=='all'});const handleSearch=()=>{if(searchTerm.trim()){// Track daily task completion\ntrackLocalDealsSearch(searchTerm);refetchSearch();setActiveTab('search');}};const handleKeyPress=e=>{if(e.key==='Enter'){handleSearch();}};const formatPrice=price=>{return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(price);};const getDealScoreColor=score=>{if(score>=80)return'text-green-400';if(score>=60)return'text-yellow-400';return'text-red-400';};const getDealScoreBg=score=>{if(score>=80)return'bg-green-500/20 border-green-500/30';if(score>=60)return'bg-yellow-500/20 border-yellow-500/30';return'bg-red-500/20 border-red-500/30';};const renderDealCard=(deal,index)=>{var _deal$aiScore,_deal$aiScore2,_deal$aiScore3,_deal$aiScore4,_deal$aiScore5,_deal$aiScore6;return/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.3,delay:index*0.1},className:\"bg-gray-800 rounded-xl p-6 border border-gray-700 hover:border-purple-500/50 transition-all duration-300 group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"img\",{src:deal.image||deal.imageUrl,alt:deal.title,className:\"w-24 h-24 object-cover rounded-lg\",onError:e=>{e.target.src='https://via.placeholder.com/96x96?text=eBay+Item';}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white group-hover:text-purple-300 transition-colors line-clamp-2\",children:deal.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-3 py-1 rounded-full text-sm font-medium border \".concat(getDealScoreBg(((_deal$aiScore=deal.aiScore)===null||_deal$aiScore===void 0?void 0:_deal$aiScore.dealPotential)||deal.dealPotential||70),\" \").concat(getDealScoreColor(((_deal$aiScore2=deal.aiScore)===null||_deal$aiScore2===void 0?void 0:_deal$aiScore2.dealPotential)||deal.dealPotential||70)),children:[((_deal$aiScore3=deal.aiScore)===null||_deal$aiScore3===void 0?void 0:_deal$aiScore3.dealPotential)||deal.dealPotential||70,\"/100\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 text-green-400\",children:[/*#__PURE__*/_jsx(DollarSign,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:formatPrice(deal.currentBid)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 text-blue-400\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:deal.location||'eBay'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1 text-purple-400\",children:[/*#__PURE__*/_jsx(Star,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"eBay\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full border border-green-500/30\",children:[\"\\uD83D\\uDD25 \",((_deal$aiScore4=deal.aiScore)===null||_deal$aiScore4===void 0?void 0:_deal$aiScore4.trendingScore)||deal.trendingScore||0,\"% Trending\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full border border-blue-500/30\",children:[\"\\u26A1 \",((_deal$aiScore5=deal.aiScore)===null||_deal$aiScore5===void 0?void 0:_deal$aiScore5.competitionLevel)||deal.competitionLevel||'medium',\" Competition\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-purple-500/20 text-purple-400 text-xs rounded-full border border-purple-500/30\",children:[\"\\uD83D\\uDC8E \",((_deal$aiScore6=deal.aiScore)===null||_deal$aiScore6===void 0?void 0:_deal$aiScore6.dealPotential)||deal.dealPotential||0,\"% Deal Potential\"]})]}),deal.timeRemaining&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-500/10 border border-red-500/20 rounded-lg p-3 mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-1\",children:[/*#__PURE__*/_jsx(Clock,{className:\"h-4 w-4 text-red-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-red-400\",children:\"Time Remaining\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-300\",children:[Math.floor(deal.timeRemaining/60),\"m \",deal.timeRemaining%60,\"s\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"a\",{href:deal.itemUrl,target:\"_blank\",rel:\"noopener noreferrer\",className:\"flex-1 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(ShoppingCart,{className:\"h-4 w-4\"}),\"View on eBay\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Users,{className:\"h-4 w-4\"}),deal.bidCount||0,\" Bids\"]})]})]})]})},\"\".concat(deal.platform,\"-\").concat(deal.title,\"-\").concat(index));};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-900 pt-20\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\",children:[/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:0.6},className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-extrabold text-white mb-4\",children:\"\\uD83C\\uDFE0 Local Deals Advantage\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-gray-400 max-w-3xl mx-auto\",children:\"Find amazing local deals with no shipping costs, instant pickup, and cash negotiation opportunities\"})]}),/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.6,delay:0.1},className:\"bg-gray-800 rounded-xl p-6 mb-8 border border-gray-700\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for local deals (iPhone, furniture, tools...)\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),onKeyPress:handleKeyPress,className:\"w-full pl-10 pr-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"select\",{value:searchRadius,onChange:e=>setSearchRadius(Number(e.target.value)),className:\"px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10 miles\"}),/*#__PURE__*/_jsx(\"option\",{value:25,children:\"25 miles\"}),/*#__PURE__*/_jsx(\"option\",{value:50,children:\"50 miles\"}),/*#__PURE__*/_jsx(\"option\",{value:100,children:\"100 miles\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSearch,disabled:!searchTerm.trim()||searchLoading,className:\"px-6 py-3 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors flex items-center gap-2\",children:[searchLoading?/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent\"}):/*#__PURE__*/_jsx(Search,{className:\"h-4 w-4\"}),\"Search\"]})]})]})}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.6,delay:0.2},className:\"flex gap-2 mb-8\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('trending'),className:\"px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 \".concat(activeTab==='trending'?'bg-purple-600 text-white':'bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700'),children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"h-4 w-4\"}),\"Trending Deals\"]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab('category'),className:\"px-6 py-3 rounded-lg font-medium transition-colors flex items-center gap-2 \".concat(activeTab==='category'?'bg-purple-600 text-white':'bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700'),children:[/*#__PURE__*/_jsx(Filter,{className:\"h-4 w-4\"}),\"By Category\"]})]}),activeTab==='category'&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.6,delay:0.3},className:\"mb-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:categories.map(category=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setSelectedCategory(category.id),className:\"px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 \".concat(selectedCategory===category.id?'bg-purple-600 text-white':'bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700'),children:[/*#__PURE__*/_jsx(\"span\",{children:category.icon}),category.name]},category.id))})}),/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.6,delay:0.4},className:\"bg-gradient-to-r from-green-600/20 to-blue-600/20 rounded-xl p-6 mb-8 border border-green-500/30\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-white mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Zap,{className:\"h-5 w-5 text-green-400\"}),\"Local Deals Advantages\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Truck,{className:\"h-5 w-5 text-green-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-white font-medium\",children:\"No Shipping\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm\",children:\"Save on shipping costs\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Clock,{className:\"h-5 w-5 text-blue-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-white font-medium\",children:\"Instant Pickup\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm\",children:\"Get items same day\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Users,{className:\"h-5 w-5 text-purple-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-white font-medium\",children:\"Cash Negotiation\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm\",children:\"Negotiate better prices\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(MapPin,{className:\"h-5 w-5 text-yellow-400\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-white font-medium\",children:\"Local Support\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm\",children:\"Support your community\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[activeTab==='search'&&/*#__PURE__*/_jsxs(_Fragment,{children:[searchLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-4 border-purple-500 border-t-transparent mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Searching local deals...\"})]}),searchError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/20 border border-red-500/30 rounded-xl p-6 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400\",children:\"Failed to search local deals. Please try again.\"})}),searchResults&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white\",children:[\"Search Results for \\\"\",searchTerm,\"\\\"\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-400\",children:[((_searchResults$items=searchResults.items)===null||_searchResults$items===void 0?void 0:_searchResults$items.length)||0,\" eBay items found\"]})]}),!searchResults.items||searchResults.items.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-400 text-lg\",children:[\"No eBay items found for \\\"\",searchTerm,\"\\\"\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mt-2\",children:\"Try a different search term\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:searchResults.items.map((deal,index)=>renderDealCard(deal,index))})]})]}),activeTab==='trending'&&/*#__PURE__*/_jsxs(_Fragment,{children:[trendingLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-4 border-purple-500 border-t-transparent mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-400\",children:\"Loading trending local deals...\"})]}),trendingError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/20 border border-red-500/30 rounded-xl p-6 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400\",children:\"Failed to load trending deals. Please try again.\"})}),trendingData&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-white\",children:\"Trending eBay Items\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-400\",children:[((_trendingData$items=trendingData.items)===null||_trendingData$items===void 0?void 0:_trendingData$items.length)||0,\" trending items\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:(_trendingData$items2=trendingData.items)===null||_trendingData$items2===void 0?void 0:_trendingData$items2.map((deal,index)=>renderDealCard(deal,index))})]})]}),activeTab==='category'&&selectedCategory!=='all'&&/*#__PURE__*/_jsxs(_Fragment,{children:[categoryLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-4 border-purple-500 border-t-transparent mx-auto mb-4\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-400\",children:[\"Loading \",selectedCategory,\" deals...\"]})]}),categoryError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500/20 border border-red-500/30 rounded-xl p-6 text-center\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-400\",children:\"Failed to load category deals. Please try again.\"})}),categoryData&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl font-bold text-white capitalize\",children:[selectedCategory,\" eBay Items\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-400\",children:[((_categoryData$items=categoryData.items)===null||_categoryData$items===void 0?void 0:_categoryData$items.length)||0,\" items found\"]})]}),!categoryData.items||categoryData.items.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-400 text-lg\",children:[\"No \",selectedCategory,\" items found\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-sm mt-2\",children:\"Try a different category or search term\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-6\",children:categoryData.items.map((deal,index)=>renderDealCard(deal,index))})]})]})]})]})});};export default LocalDeals;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}