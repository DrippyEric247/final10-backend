{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ericv\\\\final10\\\\client\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useMemo, useState } from \"react\";\nimport { loginUser, registerUser, setAuthToken } from \"../lib/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Load session from localStorage on first render\n  useEffect(() => {\n    const t = localStorage.getItem(\"token\");\n    const u = localStorage.getItem(\"user\");\n    if (t) {\n      setToken(t);\n      setAuthToken(t);\n    }\n    if (u) {\n      try {\n        setUser(JSON.parse(u));\n      } catch {\n        // ignore parse error\n      }\n    }\n    setLoading(false);\n  }, []);\n  const signup = async form => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await registerUser(form); // { message, token, user }\n      if (res.token) {\n        localStorage.setItem(\"token\", res.token);\n        setAuthToken(res.token);\n        setToken(res.token);\n      }\n      if (res.user) {\n        localStorage.setItem(\"user\", JSON.stringify(res.user));\n        setUser(res.user);\n      }\n      return res;\n    } catch (e) {\n      var _e$response, _e$response$data;\n      const msg = (e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || e.message || \"Signup failed\";\n      setError(msg);\n      throw e;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const login = async creds => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await loginUser(creds); // { message, token, user }\n      if (res.token) {\n        localStorage.setItem(\"token\", res.token);\n        setAuthToken(res.token);\n        setToken(res.token);\n      }\n      if (res.user) {\n        localStorage.setItem(\"user\", JSON.stringify(res.user));\n        setUser(res.user);\n      }\n      return res;\n    } catch (e) {\n      var _e$response2, _e$response2$data;\n      const msg = (e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.message) || e.message || \"Login failed\";\n      setError(msg);\n      throw e;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    setAuthToken(null);\n    setToken(null);\n    setUser(null);\n  };\n  const value = useMemo(() => ({\n    user,\n    token,\n    loading,\n    error,\n    signup,\n    login,\n    logout\n  }), [user, token, loading, error]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 10\n  }, this);\n}\n_s(AuthProvider, \"i+sJ+8mBMgA0VmicVqys3H44Ddg=\");\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  const ctx = useContext(AuthContext);\n  if (!ctx) throw new Error(\"useAuth must be used inside <AuthProvider>\");\n  return ctx;\n}\n_s2(useAuth, \"/dMy7t63NXD4eYACoT93CePwGrg=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useMemo","useState","loginUser","registerUser","setAuthToken","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","token","setToken","loading","setLoading","error","setError","t","localStorage","getItem","u","JSON","parse","signup","form","res","setItem","stringify","e","_e$response","_e$response$data","msg","response","data","message","login","creds","_e$response2","_e$response2$data","logout","removeItem","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","ctx","Error","$RefreshReg$"],"sources":["C:/Users/ericv/final10/client/src/context/AuthContext.js"],"sourcesContent":["import React, {\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useMemo,\r\n  useState,\r\n} from \"react\";\r\nimport { loginUser, registerUser, setAuthToken } from \"../lib/api\";\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // Load session from localStorage on first render\r\n  useEffect(() => {\r\n    const t = localStorage.getItem(\"token\");\r\n    const u = localStorage.getItem(\"user\");\r\n    if (t) {\r\n      setToken(t);\r\n      setAuthToken(t);\r\n    }\r\n    if (u) {\r\n      try {\r\n        setUser(JSON.parse(u));\r\n      } catch {\r\n        // ignore parse error\r\n      }\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  const signup = async (form) => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await registerUser(form); // { message, token, user }\r\n      if (res.token) {\r\n        localStorage.setItem(\"token\", res.token);\r\n        setAuthToken(res.token);\r\n        setToken(res.token);\r\n      }\r\n      if (res.user) {\r\n        localStorage.setItem(\"user\", JSON.stringify(res.user));\r\n        setUser(res.user);\r\n      }\r\n      return res;\r\n    } catch (e) {\r\n      const msg = e?.response?.data?.message || e.message || \"Signup failed\";\r\n      setError(msg);\r\n      throw e;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const login = async (creds) => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await loginUser(creds); // { message, token, user }\r\n      if (res.token) {\r\n        localStorage.setItem(\"token\", res.token);\r\n        setAuthToken(res.token);\r\n        setToken(res.token);\r\n      }\r\n      if (res.user) {\r\n        localStorage.setItem(\"user\", JSON.stringify(res.user));\r\n        setUser(res.user);\r\n      }\r\n      return res;\r\n    } catch (e) {\r\n      const msg = e?.response?.data?.message || e.message || \"Login failed\";\r\n      setError(msg);\r\n      throw e;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"user\");\r\n    setAuthToken(null);\r\n    setToken(null);\r\n    setUser(null);\r\n  };\r\n\r\n  const value = useMemo(\r\n    () => ({ user, token, loading, error, signup, login, logout }),\r\n    [user, token, loading, error]\r\n  );\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  const ctx = useContext(AuthContext);\r\n  if (!ctx) throw new Error(\"useAuth must be used inside <AuthProvider>\");\r\n  return ctx;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}